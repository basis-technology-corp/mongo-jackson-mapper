<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Mar 17, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
        <style>body{padding-top: 20px;}</style>
    
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

    
    <meta name="Date-Revision-yyyymmdd" content="20120317" />
    <meta http-equiv="Content-Language" content="en" />
    
        </head>
  <body>
        
    
        <div class="container-fluid">
                <div id="banner">
        <div class="pull-left">                  <a href="http://vznet.github.com/mongo-jackson-mapper" id="bannerLeft">
                <h2>MongoDB Jackson Mapper</h2>
                </a>
      </div>
        <div class="pull-right">                  <a href="http://developer.vz.net" id="bannerRight">
                                                <img src="images/vznet.png" alt="$alt"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>
      
      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
        
                  <li id="publishDate">Last Published: 2012-03-17</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.4.1</li>
                                      
        
              </ul>
      </div>

            <div id="leftColumn" class="sidebar">
        <div class="well">
                
        
                                   <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="About">About</a>
            </li>
                  <li class="none">
                          <a href="installation.html" title="Installation">Installation</a>
            </li>
                  <li class="none">
                          <a href="tutorial.html" title="Tutorial">Tutorial</a>
            </li>
                  <li class="none">
                          <a href="changelog.html" title="Changelog">Changelog</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                          <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                      
        
      
          
          <div id="poweredBy">
                            <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                </div>
        </div>
      </div>
      
      <div id="bodyColumn" class="content">
        <div id="contentBox">
                              
          <h1>Using Object IDs</h1><p>The simplest way to use ObjectId elements, both for document IDs and also for references to other documents (or anything) is to declare the field to have a type of <code>org.bson.types.ObjectId</code>. The Mongo Jackson Mapper will handle serialisation/deserialisation of these with no problems, no extra configuration is required.</p><p>However, there are some use cases where you may not want to use the ObjectId type, for example, if the same objects get serialised to the web, or if you just prefer dealing with more basic types. Mongo Jackson Mapper provides <em>some</em> support for this, though there are a few areas that you need to be careful about.</p><h2>@ObjectId</h2><p>The <code>@net.vz.mongodb.jackson.ObjectId</code> annotation can be added to any <code>String</code> or <code>byte[]</code> field to indicate that you want its value to be stored as an ObjectId. It can also be added to <code>net.vz.mongodb.jackson.DBRef</code> fields who&rsquo;s ID type paramater is <code>String</code> or <code>byte[]</code>, as well as collection/array fields and <code>Map</code> fields. This annotation instructs the Mongo Jackson Mapper to serialise the given value into an ObjectId, and deserialise any encountered ObjectIds into the type of the field. The following are all valid uses:</p>
<pre><code>public class MyClass {
    @ObjectId
    public String _id;
    @ObjectId
    public byte[] someArbitraryId;
    @ObjectId
    public List&lt;String&gt; arbitraryCollectionOfIds;
    @ObjectId
    public DBRef&lt;AnotherClass, byte[]&gt; anotherObject;
    @ObjectId
    public List&lt;DBRef&lt;AnnotherClass, String&gt; collectionOfOtherObjects;
    @ObjectId
    public Map&lt;String, String&gt; mapOfStringsToObjectIds;
}
</code></pre><p>What is not currently supported is multi dimensional arrays/collections. Serialising map keys to ObjectIds are naturally not supported because MongoDB does not support ObjectIds as key values.</p><p>If using getters and setters, the annotation must be added to <em>both</em> the getter and the setter, for example:</p>
<pre><code>public class MyClass {
    private String someId;
    @ObjectId
    public String getSomeId() {
        return someId;
    }
    @ObjectId
    public void setSomeId(String someId) {
        this.someId = someId;
    }
}
</code></pre><p>If using property based <code>@JsonCreator</code> methods, then it must be added to the parameter:</p>
<pre><code>public class MyClass {
    private final String someId;
    @JsonCreator
    public MyClass(@ObjectId @JsonProperty(&quot;someId&quot;) someId) {
        this.someId = someId;
    }
    @ObjectId
    public String getSomeId() {
        return someId;
    }
}
</code></pre><p>If using custom (de)serialisers or delegate <code>@JsonCreator</code> methods, then you will need to handle the ObjectIds yourself.</p><p>If the setter for the <code>_id</code> field of the object is annotated with <code>@ObjectId</code>, then the <code>*ById()</code> methods on <code>JacksonDBCollection</code> will use serialise the passed in parameter to an ObjectId for you, and <code>WriteResult.getSavedId()</code> will deserialise it from ObjectId. If using a custom deserialiser for the bean, this will not work, even if the getter for the property is annotated with <code>@ObjectId</code>. This may be fixed in future, and is dependent on support from Jackson to give better information about configured serialisers.</p><h2>Querying ObjectId fields</h2><p>At current, the Mongo Jackson Mapper does not convert Strings and byte arrays in queries and updates to ObjectIds. It is planned in future that it may support this, dependent on Jackson supporting new features for looking up arbitrary serialisers/deserialisers for given fields. To query a field that is of type ObjectId, you must supply a <code>org.json.types.ObjectId</code> value, regardless of whether the field is annotated with <code>@ObjectId</code>. For example:</p>
<pre><code>String myStringId = ...
coll.find(DBQuery.is(&quot;someId&quot;, new ObjectId(myStringId));
</code></pre>
                  </div>
      </div>
    </div>

    <footer class="footer">
            <div class="container-fluid">
              <div class="row span16">Copyright &copy;                    2011-2012
                        <a href="http://vz.net">VZ Netzwerke</a>.
            All Rights Reserved.      
        
      </div>

                      </div>
    </footer>
  </body>
</html>
